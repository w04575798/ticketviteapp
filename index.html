<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Concert Ticket Website - Checkout</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }

    body {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      background-color: #f5f5f5;
    }

    header {
      background: #222;
      color: #fff;
      padding: 20px 50px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header nav a {
      color: #bbb;
      margin-left: 20px;
      text-decoration: none;
      font-size: 14px;
    }

    main {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 40px 50px;
      gap: 40px;
    }

    .checkout-form, .order-summary {
      background: #fff;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .checkout-form {
      flex: 2;
    }

    .order-summary {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h2 {
      margin-bottom: 20px;
      color: #333;
    }

    form section {
      margin-bottom: 30px;
    }

    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #555;
    }

    input {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    .concert-img {
      width: 100%;
      max-width: 150px; /* Thumbnail image size */
      height: auto;
      border-radius: 10px;
      margin-bottom: 20px;
    }

    .order-summary img {
      width: 100%;
      height: auto;
      border-radius: 10px;
      margin-bottom: 20px;
    }

    .summary-details {
      text-align: center;
    }

    footer {
      background: #222;
      color: #fff;
      padding: 40px 50px;
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
    }

    footer div {
      margin-bottom: 20px;
    }

    footer h3 {
      margin-bottom: 10px;
    }

    footer p, footer a {
      color: #bbb;
      font-size: 14px;
      text-decoration: none;
    }

    .logo {
      font-size: 24px;
      font-weight: bold;
      color: #ff5252;
    }

    .error {
      color: red;
      font-size: 0.9rem;
      margin-top: 5px;
    }

    .valid {
      color: green;
      font-size: 0.9rem;
      margin-top: 5px;
    }

    .total-cost {
      font-weight: bold;
      font-size: 18px;
      margin-top: 10px;
    }

    button {
      width: 100%;
      padding: 12px;
      background-color: #ff5252;
      color: white;
      font-size: 16px;
      font-weight: bold;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #ff1744;
    }

    button:focus {
      outline: none;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">Concert Tickets</div>
    <nav>
      <a href="#">Home</a>
      <a href="#">Events</a>
      <a href="#">Contact</a>
    </nav>
  </header>

  <main>
    <div class="checkout-form">
      <h2>Buy Tickets for The Rolling Stones</h2>
      
      <form id="ticketForm">
        <input type="hidden" name="ConcertId" value="1" />
        
        <section>
          <label for="name">Full Name</label>
          <input name="Name" id="name" placeholder="Full Name" required />
          <div id="nameFeedback" class="error"></div>
        </section>

        <section>
          <label for="email">Email</label>
          <input type="email" name="Email" id="email" placeholder="Email" required />
          <div id="emailFeedback" class="error"></div>
        </section>

        <section>
          <label for="phone">Phone Number</label>
          <input name="Phone" id="phone" placeholder="Phone Number" required />
          <div id="phoneFeedback" class="error"></div>
        </section>

        <section>
          <label for="quantity">Number of Tickets</label>
          <input type="number" name="Quantity" id="quantity" placeholder="Number of Tickets" required min="1" value="1" />
          <div id="quantityFeedback" class="error"></div>
        </section>

        <section>
          <label for="creditCard">Credit Card Number</label>
          <input name="CreditCard" id="creditCard" placeholder="Credit Card Number" required />
          <div id="creditCardFeedback" class="error"></div>
        </section>

        <section>
          <label for="expiration">Expiration (MM/YY)</label>
          <input name="Expiration" id="expiration" placeholder="Expiration (MM/YY)" required />
          <div id="expirationFeedback" class="error"></div>
        </section>

        <section>
          <label for="securityCode">CVV</label>
          <input name="SecurityCode" id="securityCode" placeholder="CVV" required />
          <div id="securityCodeFeedback" class="error"></div>
        </section>

        <section>
          <label for="address">Billing Address</label>
          <input name="Address" id="address" placeholder="Billing Address" required />
          <div id="addressFeedback" class="error"></div>
        </section>

        <section>
          <label for="city">City</label>
          <input name="City" id="city" placeholder="City" required />
          <div id="cityFeedback" class="error"></div>
        </section>

        <section>
          <label for="province">Province/State</label>
          <input name="Province" id="province" placeholder="Province/State" required />
          <div id="provinceFeedback" class="error"></div>
        </section>

        <section>
          <label for="postalCode">Postal Code</label>
          <input name="PostalCode" id="postalCode" placeholder="Postal Code" required />
          <div id="postalCodeFeedback" class="error"></div>
        </section>

        <section>
          <label for="country">Country</label>
          <input name="Country" id="country" placeholder="Country" required />
          <div id="countryFeedback" class="error"></div>
        </section>

        <button type="submit">Buy Tickets</button>
      </form>
    </div>

    <div class="order-summary">
      <h2>Order Summary</h2>
      <img src="thumb.jpg" alt="Order Summary Image" />
      <div class="summary-details">
        <span><strong>Event:</strong> The Rolling Stones - No Filter Tour</span><br>
        <span><strong>Date:</strong> September 19, 2025</span><br>
        <span><strong>Location:</strong> Rose Bowl, Pasadena, CA</span><br>
        <span><strong>Tickets:</strong> <span id="ticketQuantity">1</span></span><br>
        <span><strong>Total:</strong> $<span id="totalCost">100</span></span>
      </div>
    </div>
  </main>

  <footer>
    <div class="logo">Concert Tickets</div>
    <div>
      <h3>About</h3>
      <p>Our mission is to bring you closer to the concerts you love.</p>
    </div>
    <div>
      <h3>Contact</h3>
      <p>Email: info@concerttickets.com</p>
    </div>
    <div>
      <h3>Follow Us</h3>
      <a href="#">Facebook</a>
      <a href="#">Twitter</a>
      <a href="#">Instagram</a>
    </div>
  </footer>

  <script>
    const ticketPrice = 100; // Price per ticket
  
    // Update total price when quantity changes
    document.getElementById('quantity').addEventListener('input', function() {
      const quantity = parseInt(this.value, 10);
      const totalCost = ticketPrice * quantity;
      document.getElementById('ticketQuantity').textContent = quantity;
      document.getElementById('totalCost').textContent = totalCost;
    });
  
    // Real-time Validation Functions
    function validateName() {
      const name = document.getElementById('name').value;
      const nameFeedback = document.getElementById('nameFeedback');
      const regex = /^[a-zA-Z\s]+$/; // Only letters and spaces
      if (regex.test(name)) {
        nameFeedback.textContent = '';
        nameFeedback.className = 'valid';
      } else {
        nameFeedback.textContent = 'Invalid name. Only letters and spaces are allowed.';
        nameFeedback.className = 'error';
      }
    }
  
    function validateEmail() {
      const email = document.getElementById('email').value;
      const emailFeedback = document.getElementById('emailFeedback');
      const regex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;
      if (regex.test(email)) {
        emailFeedback.textContent = '';
        emailFeedback.className = 'valid';
      } else {
        emailFeedback.textContent = 'Invalid email.';
        emailFeedback.className = 'error';
      }
    }
  
    function validatePhone() {
      const phone = document.getElementById('phone').value;
      const phoneFeedback = document.getElementById('phoneFeedback');
      const regex = /^\+?[1-9]\d{1,14}$/; // International phone format
      if (regex.test(phone)) {
        phoneFeedback.textContent = '';
        phoneFeedback.className = 'valid';
      } else {
        phoneFeedback.textContent = 'Invalid format. No letters, dashes or spaces';
        phoneFeedback.className = 'error';
      }
    }
  
    function validateCard() {
      const card = document.getElementById('creditCard').value;
      const cardFeedback = document.getElementById('creditCardFeedback');
      const regex = /^[0-9]{16}$/; // 16-digit credit card number
      if (regex.test(card)) {
        cardFeedback.textContent = '';
        cardFeedback.className = 'valid';
      } else {
        cardFeedback.textContent = 'Invalid credit card number.';
        cardFeedback.className = 'error';
      }
    }
  
    function validateExpiration() {
      const expiration = document.getElementById('expiration').value;
      const expirationFeedback = document.getElementById('expirationFeedback');
      const regex = /^(0[1-9]|1[0-2])\/\d{2}$/; // MM/YY format
      if (regex.test(expiration)) {
        expirationFeedback.textContent = '';
        expirationFeedback.className = 'valid';
      } else {
        expirationFeedback.textContent = 'Invalid date format. Use MM/YY.';
        expirationFeedback.className = 'error';
      }
    }
  
    // Form submission to API
    document.getElementById('ticketForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      // Perform all validations
      validateName();
      validateEmail();
      validatePhone();
      validateCard();
      validateExpiration();

      // Check if there are any validation errors
      const errorElements = document.querySelectorAll('.error');
      const hasErrors = Array.from(errorElements).some(el => el.textContent.trim() !== '');

      if (hasErrors) {
        alert('Please correct the errors before submitting.');
        return;
      }

      // Prepare form data
      const formData = new FormData(e.target);
      const json = JSON.stringify(Object.fromEntries(formData));

      try {
        const response = await fetch('https://nscc-0475798-tickets-api-h7hbc9fte5apgqet.canadacentral-01.azurewebsites.net/api/tickets', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: json
        });

        if (response.ok) {
          alert('Ticket purchase submitted successfully!');
          e.target.reset();
        } else {
          alert('Something went wrong while submitting the form.');
        }
      } catch (err) {
        console.error(err);
        alert('Failed to connect to the server.');
      }
    });

    // Event listeners for validation
    document.getElementById('name').addEventListener('input', validateName);
    document.getElementById('email').addEventListener('input', validateEmail);
    document.getElementById('phone').addEventListener('input', validatePhone);
    document.getElementById('creditCard').addEventListener('input', validateCard);
    document.getElementById('expiration').addEventListener('input', validateExpiration);
  </script>
</body>
</html>